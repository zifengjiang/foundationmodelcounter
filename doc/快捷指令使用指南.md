# 快捷指令使用指南 - 配合 Action Button 一键记账

## 功能介绍

现在你可以使用 iOS 快捷指令在 app 外快速记账！**特别适合 iPhone 15 Pro/Pro Max 的 Action Button**。

### 工作原理

在快捷指令中创建一个组合流程：
1. **截取屏幕** → 系统自动截屏
2. **图片记账** → AI 识别并保存

配合 Action Button，实现**在任何界面一键截屏记账**，无需先手动截屏！

## 快速开始 - 5分钟配置

### 步骤 1: 创建快捷指令

1. 打开 iOS **快捷指令** App
2. 点击右上角 **+** 创建新快捷指令
3. 添加动作：
   - 搜索并添加 **"截取屏幕"**
   - 搜索并添加 **"图片记账"**（来自 FoundationModelCounter）
4. 确保"截取屏幕"的输出自动连接到"图片记账"的图片输入
5. 命名为 **"一键记账"**
6. 点击完成

### 步骤 2: 配置 Action Button（iPhone 15 Pro/Pro Max）

1. 打开 **设置** > **动作按钮**
2. 滑动选择 **"快捷指令"**
3. 点击 **"选取"**
4. 选择刚创建的 **"一键记账"** 快捷指令
5. 完成！

### 步骤 3: 开始使用

1. 打开任何账单页面（支付宝、微信等）
2. 长按 **Action Button**（左侧音量键下方）
3. 系统自动截屏 → AI识别 → 保存记录
4. 震动反馈，完成！

## 其他触发方式

### 1. 背部轻点（所有iPhone）

适合没有 Action Button 的机型：

1. 打开 **设置** > **辅助功能** > **触控** > **背面轻点**
2. 选择 **"轻点两下"** 或 **"轻点三下"**
3. 选择你的 **"一键记账"** 快捷指令
4. 完成！现在轻点手机背面即可记账

### 2. 主屏幕小组件

1. 长按主屏幕空白处，进入编辑模式
2. 点击左上角 **+** 按钮
3. 搜索 **"快捷指令"** 小组件
4. 添加到主屏幕
5. 长按小组件，选择 **"编辑小组件"**
6. 选择 **"一键记账"**

### 3. Siri 语音命令

对 Siri 说：
- **"嘿 Siri，一键记账"**
- **"嘿 Siri，图片记账"**

### 4. 锁屏小组件（iOS 16+）

1. 长按锁屏界面
2. 点击 **"自定义"**
3. 添加快捷指令小组件
4. 选择 **"一键记账"**

## 使用场景

### 场景 1：日常消费（推荐 Action Button）

1. 支付宝/微信支付成功页面
2. 长按 Action Button
3. 完成！无需任何其他操作

### 场景 2：线上购物

1. 浏览订单详情页
2. 长按 Action Button
3. AI 自动提取金额、商品信息

### 场景 3：转账收款

1. 显示收款成功页面
2. 长按 Action Button
3. 记录收入（可在快捷指令中设置默认为"收入"类型）

### 场景 4：批量记账

1. 在相册中选择历史账单截屏
2. 点击分享 → 选择"图片记账"
3. 快速处理多笔账单

## 进阶配置

### 创建"收入记账"快捷指令

1. 复制"一键记账"快捷指令
2. 点击"图片记账"动作
3. 将"交易类型"参数改为 **"收入"**
4. 重命名为"一键记收入"
5. 可以配置到背部轻点的"轻点三下"

### 创建智能快捷指令（根据时间自动判断）

```
如果 当前时间 在 9:00 - 18:00 之间
    设置 交易类型 = "支出"
否则
    设置 交易类型 = "收入"

截取屏幕
图片记账（使用上述交易类型）
```

### 添加确认步骤（避免误触）

```
截取屏幕
显示结果（预览截屏）
询问"确认记账吗？"
    如果"是" → 图片记账
    如果"否" → 停止
```

### 添加成功通知

```
截取屏幕
图片记账
显示通知"记账完成！"
震动反馈
```

## Action Button 最佳实践

### 建议配置

**iPhone 15 Pro/Pro Max 用户强烈推荐：**

- **Action Button**: 一键记账（支出）
- **背部轻点两下**: 一键记收入
- **背部轻点三下**: 打开记账App

### 使用技巧

1. **快速触发**: 长按约 1 秒即可触发
2. **静音模式**: Action Button 在静音模式下也能正常工作
3. **震动反馈**: 通过震动确认操作已执行
4. **误触防护**: 可在快捷指令中添加确认步骤

### 常见问题

**Q: Action Button 没反应？**
A: 
- 确保长按而不是短按
- 检查设置中 Action Button 是否已配置为"快捷指令"
- 确认选择了正确的快捷指令

**Q: 可以配置其他按钮吗？**
A: 
- iPhone 15 系列只有 Pro/Pro Max 有 Action Button
- 其他机型推荐使用背部轻点

## 自动化规则

### 场景一：每天晚上提醒记账

1. 打开快捷指令 App
2. 切换到 **"自动化"** 标签
3. 点击 **"+"** 创建个人自动化
4. 选择 **"特定时间"**
5. 设置时间为 **22:00**
6. 添加动作：**"显示通知"** - "记得记账哦！"
7. 关闭 **"运行前询问"**

### 场景二：打开支付宝时提醒

1. 创建自动化
2. 选择 **"App"**
3. 选择 **"支付宝"** 或 **"微信"**
4. 设置为 **"打开时"**
5. 添加通知提醒

### 场景三：连接家里Wi-Fi时提醒记录今日支出

1. 创建自动化
2. 选择 **"Wi-Fi"**
3. 选择家里的 Wi-Fi
4. 添加通知动作

## 注意事项

1. **相册权限**: 首次使用时需要授予相册访问权限（用于保存账单图片）
2. **AI 服务配置**: 确保在 App 设置中已配置 AI 服务（Apple AI 或 DeepSeek）
3. **网络连接**: 如果使用 DeepSeek API，需要网络连接
4. **截屏质量**: 确保账单信息完整显示，文字清晰可见
5. **数据校验**: AI 识别后建议定期在 App 中检查准确性
6. **重复检测**: 系统会自动检测重复记账（相同金额+时间±2分钟），如遇重复会提示跳过

## 故障排除

### 问题：快捷指令找不到"图片记账"动作
**解决方案**：
1. 确保应用已在真机上运行过一次
2. 重启快捷指令 App
3. 检查 Xcode 编译是否成功

### 问题：截屏后没有反应
**解决方案**：
1. 检查两个动作是否正确连接
2. 查看快捷指令的错误提示
3. 确认 AI 服务是否已配置

### 问题：提示"检测到可能的重复记账"
**解决方案**：
这是正常的防重复功能，说明：
1. 在过去 2 分钟内已有相同金额的记录
2. 系统自动跳过，避免重复
3. 如果确实需要添加，请在 App 中手动添加
4. 这可以防止误触 Action Button 导致的重复记账

### 问题：识别不准确
**解决方案**：
1. 确保账单信息完整显示在屏幕上
2. 尽量放大账单详情页面
3. 避免有遮挡或模糊的文字
4. 在 App 中手动编辑修正

**提示**：系统已自动裁剪顶部状态栏（60pt），排除时间、电量等信息的干扰 ✅

### 问题：Action Button 配置后无法修改
**解决方案**：
1. 进入设置 > 动作按钮
2. 重新选择快捷指令或其他功能
3. 可以随时更改 Action Button 的功能

## 性能优化建议

1. **后台处理**: 快捷指令在后台运行，不影响其他操作
2. **响应速度**: 整个流程通常在 2-3 秒内完成
3. **电池影响**: 极小，AI 处理在设备端完成（使用 Apple AI 时）
4. **网络流量**: 使用 Apple AI 时无需网络，DeepSeek API 每次约 1-2KB

## 与其他 App 集成

### 从其他 App 分享

支持从以下途径分享图片到记账：
- 照片 App
- 微信/QQ（长按图片 → 保存 → 分享）
- 邮件附件
- Safari 网页图片
- 剪贴板图片

### 组合使用示例

**示例 1: 网页账单记账**
```
从 Safari → 截屏 → 图片记账
```

**示例 2: 批量导入**
```
从相册选择多张照片 → 重复执行图片记账
```

**示例 3: OCR + 手动确认**
```
截取屏幕 → 预览 → 确认 → 图片记账
```

## 总结

### 推荐配置（iPhone 15 Pro/Pro Max）
- ✅ **Action Button**: 一键记账（最常用）
- ✅ **背部轻点两下**: 记收入
- ✅ **锁屏小组件**: 快速入口

### 推荐配置（其他 iPhone）
- ✅ **背部轻点两下**: 一键记账
- ✅ **背部轻点三下**: 打开 App
- ✅ **主屏幕小组件**: 快速入口

### 使用流程
```
看到账单 → 按 Action Button → 完成！
（总共 1 秒，无需任何其他操作）
```

## 下一步

- 📱 试试 Action Button 的便利性
- 🎯 创建个性化的快捷指令流程
- ⚙️ 设置自动化规则
- 📊 定期在 App 中查看统计数据

**享受极速记账的快感！** ⚡️

---

需要帮助？查看 [SHORTCUTS_SETUP.md](SHORTCUTS_SETUP.md) 了解详细配置步骤。
